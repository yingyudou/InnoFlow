<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€šçŸ¥ä¸­å¿ƒ - InnoFlow</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/animation.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-left">
            <img src="assets/logo.svg" alt="InnoFlow" class="nav-logo">
            <span class="nav-title">InnoFlow - é€šçŸ¥ä¸­å¿ƒ</span>
        </div>
        <div class="nav-right">
            <button class="btn-secondary" onclick="window.location.href='dashboard.html'">è¿”å›ä¸»é¡µ</button>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1>é€šçŸ¥ä¸­å¿ƒ</h1>
                    <p class="page-subtitle">æŸ¥çœ‹æ‰€æœ‰ç³»ç»Ÿé€šçŸ¥å’Œæ¶ˆæ¯</p>
                </div>
                <div style="display: flex; gap: 12px;">
                    <button class="btn-secondary" onclick="markAllAsRead()">å…¨éƒ¨æ ‡è®°ä¸ºå·²è¯»</button>
                    <button class="btn-secondary" onclick="clearAllNotifications()">æ¸…ç©ºé€šçŸ¥</button>
                </div>
            </div>
        </div>

        <div id="notificationsList">
            <!-- é€šçŸ¥åˆ—è¡¨å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <script src="js/notification.js"></script>
    <script>
        // æ¸²æŸ“é€šçŸ¥åˆ—è¡¨
        function renderNotificationList() {
            const container = document.getElementById('notificationsList');
            if (!container) return;

            const unreadNotifications = notifications.filter(n => !n.read);
            const readNotifications = notifications.filter(n => n.read);

            if (notifications.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 80px 20px;">
                        <div style="font-size: 64px; margin-bottom: 24px;">ğŸ””</div>
                        <h2 style="font-size: 24px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">æš‚æ— é€šçŸ¥</h2>
                        <p style="color: var(--text-secondary);">å½“ä½ æ”¶åˆ°æ–°çš„é€šçŸ¥æ—¶ï¼Œå®ƒä»¬ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                ${unreadNotifications.length > 0 ? `
                    <div style="margin-bottom: 24px;">
                        <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 16px; color: var(--primary-color);">
                            æœªè¯»é€šçŸ¥ (${unreadNotifications.length})
                        </h2>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            ${unreadNotifications.map(n => renderNotificationCard(n, false)).join('')}
                        </div>
                    </div>
                ` : ''}

                ${readNotifications.length > 0 ? `
                    <div>
                        <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 16px; color: var(--text-secondary);">
                            å·²è¯»é€šçŸ¥ (${readNotifications.length})
                        </h2>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            ${readNotifications.map(n => renderNotificationCard(n, true)).join('')}
                        </div>
                    </div>
                ` : ''}
            `;
        }

        // æ¸²æŸ“é€šçŸ¥å¡ç‰‡
        function renderNotificationCard(notification, isRead) {
            const typeConfig = notificationTypes[notification.type] || notificationTypes.system;

            return `
                <div class="notification-card"
                     onclick="handleNotificationClick(${notification.id}, '${notification.link}')"
                     style="background: white; border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; cursor: pointer; transition: all 0.2s; ${!isRead ? 'border-left: 4px solid ' + typeConfig.color + ';' : ''}"
                     onmouseover="this.style.boxShadow='var(--shadow-md)'; this.style.transform='translateY(-2px)'"
                     onmouseout="this.style.boxShadow='none'; this.style.transform='translateY(0)'">
                    <div style="display: flex; gap: 16px;">
                        <div style="font-size: 32px; flex-shrink: 0;">${typeConfig.icon}</div>
                        <div style="flex: 1; min-width: 0;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                <div style="font-weight: 600; font-size: 16px; ${!isRead ? 'color: var(--text-primary);' : 'color: var(--text-secondary);'}">
                                    ${notification.title}
                                </div>
                                <div style="display: flex; gap: 8px; align-items: center;">
                                    ${!isRead ? '<div style="width: 10px; height: 10px; background: var(--primary-color); border-radius: 50%;"></div>' : ''}
                                    <button class="btn-text" onclick="deleteNotification(${notification.id}); event.stopPropagation();"
                                            style="padding: 4px 8px; font-size: 12px; color: var(--text-secondary);">
                                        âœ•
                                    </button>
                                </div>
                            </div>
                            <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px; line-height: 1.6;">
                                ${notification.message}
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary);">
                                ${notification.time}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // æ¸…ç©ºæ‰€æœ‰é€šçŸ¥
        function clearAllNotifications() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰é€šçŸ¥å—ï¼Ÿ')) {
                notifications = [];
                updateNotificationBadge();
                renderNotificationList();
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            renderNotificationList();
        });

        // å¯¼å‡ºå‡½æ•°
        window.renderNotificationList = renderNotificationList;
        window.clearAllNotifications = clearAllNotifications;
    </script>
</body>
</html>
